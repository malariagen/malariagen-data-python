# Grantham substitution matrix
# Grantham scores is a measure of the difference between amino acids
GRANTHAM_SCORES = {
    "S": {
        "R": 110,
        "L": 145,
        "P": 74,
        "T": 58,
        "A": 99,
        "V": 124,
        "G": 56,
        "I": 142,
        "F": 155,
        "Y": 144,
        "C": 112,
        "H": 89,
        "Q": 68,
        "N": 46,
        "K": 121,
        "D": 65,
        "E": 80,
        "M": 135,
        "W": 177,
    },
    "R": {
        "L": 102,
        "P": 103,
        "T": 71,
        "A": 112,
        "V": 96,
        "G": 125,
        "I": 97,
        "F": 97,
        "Y": 77,
        "C": 180,
        "H": 29,
        "Q": 43,
        "N": 86,
        "K": 26,
        "D": 96,
        "E": 54,
        "M": 91,
        "W": 101,
    },
    "L": {
        "P": 98,
        "T": 92,
        "A": 96,
        "V": 32,
        "G": 138,
        "I": 5,
        "F": 22,
        "Y": 36,
        "C": 198,
        "H": 99,
        "Q": 113,
        "N": 153,
        "K": 107,
        "D": 172,
        "E": 138,
        "M": 15,
        "W": 61,
    },
    "P": {
        "T": 38,
        "A": 27,
        "V": 68,
        "G": 42,
        "I": 95,
        "F": 114,
        "Y": 110,
        "C": 169,
        "H": 77,
        "Q": 76,
        "N": 91,
        "K": 103,
        "D": 108,
        "E": 93,
        "M": 87,
        "W": 147,
    },
    "T": {
        "A": 58,
        "V": 69,
        "G": 59,
        "I": 89,
        "F": 103,
        "Y": 92,
        "C": 149,
        "H": 47,
        "Q": 42,
        "N": 65,
        "K": 78,
        "D": 85,
        "E": 65,
        "M": 81,
        "W": 128,
    },
    "A": {
        "V": 64,
        "G": 60,
        "I": 94,
        "F": 113,
        "Y": 112,
        "C": 195,
        "H": 86,
        "Q": 91,
        "N": 111,
        "K": 106,
        "D": 126,
        "E": 107,
        "M": 84,
        "W": 148,
    },
    "V": {
        "G": 109,
        "I": 29,
        "F": 50,
        "Y": 55,
        "C": 192,
        "H": 84,
        "Q": 96,
        "N": 133,
        "K": 97,
        "D": 152,
        "E": 121,
        "M": 21,
        "W": 88,
    },
    "G": {
        "I": 135,
        "F": 153,
        "Y": 147,
        "C": 159,
        "H": 98,
        "Q": 87,
        "N": 80,
        "K": 127,
        "D": 94,
        "E": 98,
        "M": 127,
        "W": 184,
    },
    "I": {
        "F": 21,
        "Y": 33,
        "C": 198,
        "H": 94,
        "Q": 109,
        "N": 149,
        "K": 102,
        "D": 168,
        "E": 134,
        "M": 10,
        "W": 61,
    },
    "F": {
        "Y": 22,
        "C": 205,
        "H": 100,
        "Q": 116,
        "N": 158,
        "K": 102,
        "D": 177,
        "E": 140,
        "M": 28,
        "W": 40,
    },
    "Y": {
        "C": 194,
        "H": 83,
        "Q": 99,
        "N": 143,
        "K": 85,
        "D": 160,
        "E": 122,
        "M": 36,
        "W": 37,
    },
    "C": {
        "H": 174,
        "Q": 154,
        "N": 139,
        "K": 202,
        "D": 154,
        "E": 170,
        "M": 196,
        "W": 215,
    },
    "H": {"Q": 46, "N": 32, "K": 81, "D": 40, "E": 87, "M": 115},
    "Q": {"N": 53, "K": 61, "D": 29, "E": 101, "M": 130},
    "N": {"K": 23, "D": 42, "E": 142, "M": 174},
    "K": {"D": 56, "E": 95, "M": 110},
    "D": {"E": 160, "M": 181},
    "E": {"M": 152},
    # M has no nonzero except for itself (M->M = 67)
    "M": {"M": 67},
}


# Safe lookup function
def grantham_score(row, col):
    score = GRANTHAM_SCORES.get(row, {}).get(col)
    if score is None:
        score = GRANTHAM_SCORES.get(col, {}).get(row)
    return score


# Sneath dissimilarity matrix (percentage dissimilarity, symmetric)
SNEATH_SCORE = {
    "I": {
        "I": 0,
        "L": 5,
        "V": 9,
        "G": 24,
        "A": 15,
        "P": 23,
        "Q": 22,
        "N": 20,
        "M": 20,
        "T": 23,
        "S": 23,
        "C": 24,
        "E": 30,
        "D": 25,
        "K": 23,
        "R": 33,
        "Y": 30,
        "F": 19,
        "W": 30,
        "H": 25,
    },
    "L": {
        "I": 5,
        "L": 0,
        "V": 7,
        "G": 25,
        "A": 17,
        "P": 24,
        "Q": 24,
        "N": 23,
        "M": 22,
        "T": 21,
        "S": 25,
        "C": 26,
        "E": 31,
        "D": 28,
        "K": 24,
        "R": 34,
        "Y": 34,
        "F": 22,
        "W": 34,
        "H": 28,
    },
    "V": {
        "I": 9,
        "L": 7,
        "V": 0,
        "G": 19,
        "A": 12,
        "P": 20,
        "Q": 25,
        "N": 23,
        "M": 23,
        "T": 17,
        "S": 20,
        "C": 21,
        "E": 31,
        "D": 28,
        "K": 26,
        "R": 36,
        "Y": 36,
        "F": 26,
        "W": 37,
        "H": 31,
    },
    "G": {
        "I": 24,
        "L": 25,
        "V": 19,
        "G": 0,
        "A": 9,
        "P": 17,
        "Q": 32,
        "N": 26,
        "M": 34,
        "T": 20,
        "S": 19,
        "C": 21,
        "E": 37,
        "D": 33,
        "K": 31,
        "R": 43,
        "Y": 36,
        "F": 29,
        "W": 39,
        "H": 34,
    },
    "A": {
        "I": 15,
        "L": 17,
        "V": 12,
        "G": 9,
        "A": 0,
        "P": 16,
        "Q": 26,
        "N": 25,
        "M": 25,
        "T": 20,
        "S": 16,
        "C": 13,
        "E": 34,
        "D": 30,
        "K": 26,
        "R": 37,
        "Y": 34,
        "F": 26,
        "W": 36,
        "H": 29,
    },
    "P": {
        "I": 23,
        "L": 24,
        "V": 20,
        "G": 17,
        "A": 16,
        "P": 0,
        "Q": 33,
        "N": 31,
        "M": 31,
        "T": 20,
        "S": 24,
        "C": 25,
        "E": 43,
        "D": 40,
        "K": 31,
        "R": 43,
        "Y": 37,
        "F": 27,
        "W": 37,
        "H": 36,
    },
    "Q": {
        "I": 22,
        "L": 24,
        "V": 25,
        "G": 32,
        "A": 26,
        "P": 33,
        "Q": 0,
        "N": 10,
        "M": 13,
        "T": 25,
        "S": 24,
        "C": 22,
        "E": 14,
        "D": 22,
        "K": 21,
        "R": 23,
        "Y": 29,
        "F": 24,
        "W": 31,
        "H": 27,
    },
    "N": {
        "I": 20,
        "L": 23,
        "V": 23,
        "G": 26,
        "A": 25,
        "P": 31,
        "Q": 10,
        "N": 0,
        "M": 21,
        "T": 19,
        "S": 15,
        "C": 19,
        "E": 19,
        "D": 14,
        "K": 27,
        "R": 31,
        "Y": 28,
        "F": 24,
        "W": 32,
        "H": 27,
    },
    "M": {
        "I": 20,
        "L": 22,
        "V": 23,
        "G": 34,
        "A": 25,
        "P": 31,
        "Q": 13,
        "N": 21,
        "M": 0,
        "T": 25,
        "S": 22,
        "C": 17,
        "E": 26,
        "D": 31,
        "K": 24,
        "R": 28,
        "Y": 32,
        "F": 24,
        "W": 31,
        "H": 30,
    },
    "T": {
        "I": 23,
        "L": 21,
        "V": 17,
        "G": 20,
        "A": 20,
        "P": 20,
        "Q": 25,
        "N": 19,
        "M": 25,
        "T": 0,
        "S": 12,
        "C": 19,
        "E": 34,
        "D": 29,
        "K": 34,
        "R": 38,
        "Y": 32,
        "F": 28,
        "W": 38,
        "H": 34,
    },
    "S": {
        "I": 23,
        "L": 25,
        "V": 20,
        "G": 19,
        "A": 16,
        "P": 24,
        "Q": 24,
        "N": 15,
        "M": 22,
        "T": 12,
        "S": 0,
        "C": 13,
        "E": 29,
        "D": 25,
        "K": 31,
        "R": 37,
        "Y": 32,
        "F": 28,
        "W": 35,
        "H": 28,
    },
    "C": {
        "I": 24,
        "L": 26,
        "V": 21,
        "G": 21,
        "A": 13,
        "P": 25,
        "Q": 22,
        "N": 19,
        "M": 17,
        "T": 19,
        "S": 13,
        "C": 0,
        "E": 33,
        "D": 28,
        "K": 32,
        "R": 36,
        "Y": 29,
        "F": 25,
        "W": 37,
        "H": 31,
    },
    "E": {
        "I": 30,
        "L": 31,
        "V": 31,
        "G": 37,
        "A": 34,
        "P": 43,
        "Q": 14,
        "N": 19,
        "M": 26,
        "T": 34,
        "S": 29,
        "C": 33,
        "E": 0,
        "D": 7,
        "K": 26,
        "R": 31,
        "Y": 34,
        "F": 35,
        "W": 43,
        "H": 27,
    },
    "D": {
        "I": 25,
        "L": 28,
        "V": 28,
        "G": 33,
        "A": 30,
        "P": 40,
        "Q": 22,
        "N": 14,
        "M": 31,
        "T": 29,
        "S": 25,
        "C": 28,
        "E": 7,
        "D": 0,
        "K": 34,
        "R": 39,
        "Y": 34,
        "F": 35,
        "W": 45,
        "H": 35,
    },
    "K": {
        "I": 23,
        "L": 24,
        "V": 26,
        "G": 31,
        "A": 26,
        "P": 31,
        "Q": 21,
        "N": 27,
        "M": 24,
        "T": 34,
        "S": 31,
        "C": 32,
        "E": 26,
        "D": 34,
        "K": 0,
        "R": 14,
        "Y": 34,
        "F": 28,
        "W": 34,
        "H": 27,
    },
    "R": {
        "I": 33,
        "L": 34,
        "V": 36,
        "G": 43,
        "A": 37,
        "P": 43,
        "Q": 23,
        "N": 31,
        "M": 28,
        "T": 38,
        "S": 37,
        "C": 36,
        "E": 31,
        "D": 39,
        "K": 14,
        "R": 0,
        "Y": 36,
        "F": 34,
        "W": 36,
        "H": 31,
    },
    "Y": {
        "I": 30,
        "L": 34,
        "V": 36,
        "G": 36,
        "A": 34,
        "P": 37,
        "Q": 29,
        "N": 28,
        "M": 32,
        "T": 32,
        "S": 32,
        "C": 29,
        "E": 34,
        "D": 34,
        "K": 34,
        "R": 36,
        "Y": 0,
        "F": 13,
        "W": 21,
        "H": 23,
    },
    "F": {
        "I": 19,
        "L": 22,
        "V": 26,
        "G": 29,
        "A": 26,
        "P": 27,
        "Q": 24,
        "N": 24,
        "M": 24,
        "T": 28,
        "S": 28,
        "C": 25,
        "E": 35,
        "D": 35,
        "K": 28,
        "R": 34,
        "Y": 13,
        "F": 0,
        "W": 13,
        "H": 18,
    },
    "W": {
        "I": 30,
        "L": 34,
        "V": 37,
        "G": 39,
        "A": 36,
        "P": 37,
        "Q": 31,
        "N": 32,
        "M": 31,
        "T": 38,
        "S": 35,
        "C": 37,
        "E": 43,
        "D": 45,
        "K": 34,
        "R": 36,
        "Y": 21,
        "F": 13,
        "W": 0,
        "H": 25,
    },
    "H": {
        "I": 25,
        "L": 28,
        "V": 31,
        "G": 34,
        "A": 29,
        "P": 36,
        "Q": 27,
        "N": 27,
        "M": 30,
        "T": 34,
        "S": 28,
        "C": 31,
        "E": 27,
        "D": 35,
        "K": 27,
        "R": 31,
        "Y": 23,
        "F": 18,
        "W": 25,
        "H": 0,
    },
}


# Safe lookup function
def sneath_dist(a, b):
    return SNEATH_SCORE.get(a, {}).get(b, None)
